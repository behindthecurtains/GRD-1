<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>GRD-1 Archive</title>
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
<style>
body {
  margin:0; background:#000; font-family:'Press Start 2P', monospace; color:#fff;
  display:flex; justify-content:center; align-items:flex-start; padding-top:40px;
}
#grdArea {
  width:800px; height:600px; padding:20px; background:#001c73; box-sizing:border-box;
  border:2px solid #0044aa; overflow:hidden; position:relative;
}
.banner {
  background:#c41616; color:#fff; padding:12px 16px; font-weight:800; border-radius:4px;
}
.console {
  margin-top:16px; white-space:pre-wrap; overflow-y:auto; height:200px;
  border:1px dashed rgba(255,255,255,0.06); padding:12px; font-size:14px; text-align:left;
}
#ynWrap {
  display:flex; justify-content:center; gap:20px; margin:16px 0; z-index:5;
}
.ynBtn {
  background:#fff; color:#001c73; border:2px solid #001c73; padding:12px 28px;
  font-family:'Press Start 2P'; font-weight:700; cursor:pointer; border-radius:4px;
}
.ynBtn:hover {
  background:#001c73; color:#fff;
}
.progressRow { margin-top:16px; display:none; flex-direction:column; gap:6px; }
.progressLabel { color:#dfefff; }
.progressBar { height:12px; background:rgba(255,255,255,0.06); border-radius:3px;
  overflow:hidden; border:1px solid rgba(255,255,255,0.12); position:relative;
}
#progressFill { width:0%; height:100%; background:linear-gradient(90deg,#fff,#cfe7ff);
  border-radius:3px; transition:width 0.05s linear;
}
#loginArea {
  display:none; margin-top:16px; padding:16px; border:1px solid rgba(255,255,255,0.2);
  border-radius:4px; max-width:500px; display:flex; gap:8px; align-items:center;
}
#userInput { flex:1; padding:8px; font-family:'Press Start 2P'; color:white; background:transparent;
  border:1px solid rgba(255,255,255,0.2);
}
#userEnter { padding:8px 16px; font-family:'Press Start 2P'; font-weight:700; cursor:pointer; }
.overlay {
  position:absolute; inset:0; background:rgba(0,0,0,0.9); display:flex; align-items:center; justify-content:center;
  z-index:50; opacity:0; pointer-events:none; transition:opacity 0.3s;
}
.overlay.visible { opacity:1; pointer-events:auto; }
.overlay img { max-width:80%; max-height:80%; }
.overlay button { position:absolute; top:20px; right:20px; background:#c41616; color:#fff; border:none;
  padding:8px 12px; cursor:pointer; font-weight:700;
}
.errorText { color:#ff5555; font-weight:700; }
</style>
</head>
<body>

<div id="grdArea">
  <div class="banner">WARNING &gt;&gt; GRD-1 ACCESS</div>

  <div class="console" id="console">
THE FOLLOWING RESEARCH FOOTAGE CONTAINS MATERIAL WHICH SOME VIEWERS MAY FIND TO BE DISTURBING.

ARE YOU SURE YOU WISH TO CONTINUE?
  </div>

  <div id="ynWrap"></div>

  <div class="progressRow" id="progressRow">
    <div class="progressLabel" id="progressLabel">UNPACKING: OCTOBER_CHILDREN / FOXHILL</div>
    <div class="progressBar"><div id="progressFill"></div></div>
  </div>

  <div id="loginArea">
    <div style="color:#dfefff; font-weight:700;">GRD-1 LOGIN</div>
    <input id="userInput" placeholder="ENTER USERNAME" autocomplete="off"/>
    <button id="userEnter">ENTER</button>
  </div>

  <div class="overlay" id="overlay1"><img src="" alt="Popup 1"><button id="ret1">RETURN TO LOGON</button></div>
  <div class="overlay" id="overlay2"><img src="" alt="Popup 2"><button id="ret2">RETURN TO LOGON</button></div>
  <div class="overlay" id="overlay3"><img src="" alt="Popup 3"><button id="ret3">RETURN TO LOGON</button></div>

</div>

<script>
const unpackFiles=[
  'PASCOE_92.LOG',
  'LIVE_FEED_CAM3.BIN',
  'OCC_FIELD_REPORT.TXT',
  'PIPES_VISUAL.DAT',
  'FOXHILL_DRIVE_TELEMETRY.BIN',
  'CEEFAX_SCRAPE.TXT'
];

let unlocked=[], correctUsers=['SCANNER','LABRADOR','SEDDONS'];
let entityTriggered=false;

const consoleEl=document.getElementById('console');
const progressFill=document.getElementById('progressFill');
const progressRow=document.getElementById('progressRow');
const loginArea=document.getElementById('loginArea');

// Web audio
let audioCtx=null, masterGain=null;
function initAudio(){if(audioCtx)return; audioCtx=new(window.AudioContext||window.webkitAudioContext)(); masterGain=audioCtx.createGain(); masterGain.gain.value=0.9; masterGain.connect(audioCtx.destination);}
function clickSound(freq,time=0.02){if(!audioCtx)return; const o=audioCtx.createOscillator(),g=audioCtx.createGain(); o.type='square'; o.frequency.value=freq; g.gain.value=0.06; o.connect(g); g.connect(masterGain); o.start(); o.stop(audioCtx.currentTime+time);}
function positiveBleep(){clickSound(880,0.05);}
function negativeBleep(){clickSound(220,0.08);}
function beep(){clickSound(660,0.05);}

// YES/NO buttons
function showYesNo(){
  const ynWrap=document.getElementById('ynWrap');
  ynWrap.innerHTML='';
  const yes=document.createElement('button');
  yes.className='ynBtn'; yes.textContent='YES';
  const no=document.createElement('button');
  no.className='ynBtn'; no.textContent='NO';
  ynWrap.appendChild(yes); ynWrap.appendChild(no);

  yes.onclick=no.onclick=function(){
    ynWrap.style.display='none';
    progressRow.style.display='flex';
    runUnpackSequence();
  };

  no.addEventListener('click',()=>{
    appendConsole('\nERROR: USER ATTEMPTED TO DECLINE - ACCESSING ARCHIVE ANYWAY');
    negativeBleep();
  });
}

function appendConsole(line,style=''){
  if(style) consoleEl.innerHTML+=`<span style="${style}">${line}</span>\n`;
  else consoleEl.textContent+=line+'\n';
  consoleEl.scrollTop=consoleEl.scrollHeight;
  beep();
}

// Unpack sequence
function runUnpackSequence(){
  const totalDuration=6000;
  const startTime=Date.now();
  const linesShown=new Array(unpackFiles.length).fill(false);

  function step(){
    const elapsed=Date.now()-startTime;
    let progress=Math.min(elapsed/totalDuration,1);
    let jitter=Math.random()*0.02-0.01;
    progressFill.style.width=`${Math.min(Math.max(progress+jitter,0),1)*100}%`;

    unpackFiles.forEach((file,i)=>{
      if(!linesShown[i] && progress>=(i/unpackFiles.length)*0.8+Math.random()*0.1){
        appendConsole('> UNPACKING: '+file);
        linesShown[i]=true;
      }
    });

    if(progress<1) requestAnimationFrame(step);
    else{
      unpackFiles.forEach((file,i)=>{ if(!linesShown[i]) appendConsole('> UNPACKING: '+file); });
      appendConsole('\nARCHIVE READY.\nLOGIN REQUIRED.');
      loginArea.style.display='flex';
      document.getElementById('userInput').focus();
    }
  }
  step();
}

// Login
document.getElementById('userEnter').addEventListener('click',handleLogin);
document.getElementById('userInput').addEventListener('keyup',e=>{if(e.key==='Enter') handleLogin();});

function handleLogin(){
  const input=document.getElementById('userInput').value.trim().toUpperCase();
  document.getElementById('userInput').value='';
  if(correctUsers.includes(input) && !unlocked.includes(input)){
    unlocked.push(input);
    positiveBleep();
    const overlay=document.getElementById(`overlay${correctUsers.indexOf(input)+1}`);
    overlay.classList.add('visible');
  } else if(!correctUsers.includes(input)){
    appendConsole('INVALID LOGIN - PLEASE TRY AGAIN');
    negativeBleep();
  }
}

// Return buttons
['ret1','ret2','ret3'].forEach(id=>{
  document.getElementById(id).onclick=()=>{
    document.querySelectorAll('.overlay').forEach(o=>o.classList.remove('visible'));
    if(unlocked.length===3 && !entityTriggered){
      entityTriggered=true;
      setTimeout(triggerEntityError,2000);
    }
  };
});

// Anomalous entity
function triggerEntityError(){
  const lines=[
    'WARNING: ANOMALOUS ENTITY DETECTED!',
    'SYSTEM STRUGGLING TO CONTAIN INTRUSION...',
    'ALL LOGGING CHANNELS EXPERIENCING MALFUNCTIONS...',
    'SECURITY PROTOCOLS FAILING...'
  ];
  lines.forEach((l,i)=>{
    setTimeout(()=>appendConsole(l,'color:#ff5555; font-weight:700;'), i*800);
  });
}

// Initialize
document.addEventListener('DOMContentLoaded',()=>{ initAudio(); showYesNo(); });
</script>
</body>
</html>
